# 📊 MIS v2 Excel 업로드 템플릿 가이드

## 📋 개요

에이원 MIS v2 시스템의 매출분석 데이터 업로드를 위한 표준 Excel 템플릿입니다.  
기존 오프라인 Excel 매출분석 구조를 온라인 시스템으로 이관하기 위해 설계되었습니다.

## 🎯 템플릿 구성

### 생성된 파일
- **파일명**: `MIS_v2_매출분석_업로드_템플릿_YYYYMMDD.xlsx`
- **크기**: 5개 시트, 81개 총 컬럼
- **용도**: 수동 데이터 보완 및 매출분석 업로드

### 📋 시트 구성

| 시트명 | 컬럼 수 | 설명 | 데이터 규모 |
|--------|---------|------|-------------|
| 📋 사용안내 | - | 템플릿 사용법 및 주의사항 | - |
| 📊 매출데이터 | 45개 | 일별 매출 거래 데이터 | 15,437행 x 55열 규모 지원 |
| 📦 상품마스터 | 16개 | 상품 정보 및 분류 체계 | ERPia 연동 매핑 |
| 🏢 거래처마스터 | 20개 | 거래처 정보 및 채널 분류 | 유통/채널 체계 관리 |
| 🔍 검증규칙 | 4개 | 데이터 입력 검증 규칙 | 자동 검증 기준 |

## 🔧 매출데이터 시트 상세

### 📊 컬럼 구조 (45개)

#### 1. 기본 정보 (9개)
- `일자`: 매출 날짜 (YYYY-MM-DD)
- `매출구분`: 매출/매출반품/매출취소
- `거래처코드`: 5자리 거래처 식별코드
- `거래처명`: 거래처 명칭
- `주문자명`: 주문한 고객명
- `수취인명`: 상품을 받는 고객명
- `매출전표번호`: 시스템 내부 전표번호
- `주문번호`: 주문 식별번호
- `수불구분`: 매출출고/매출반품 등

#### 2. 상품 정보 (5개)
- `상품코드`: ERPia 13자리 상품코드
- `자체코드`: 내부 관리용 상품코드
- `ERP 상품명`: ERPia 시스템 상품명
- `ERP 규격`: 상품 규격 (S/M/L 등)
- `비고/적요`: 특별 사항

#### 3. 수량/금액 정보 (6개)
- `수량`: 판매/반품 수량
- `단가`: 개당 판매 단가
- `매출액`: 총 매출 금액
- `공급액`: 공급가액 (세전)
- `공급가(-)`: 차감 공급가액
- `세액`: 부가세액

#### 4. 분류 정보 (7개) - Excel 자동분류 로직 기반
- `브랜드(대)`: NUNA, JOIE, 리안펫, 타보펫츠, 기타
- `브랜드(중)`: 세부 브랜드 분류
- `제품군`: 카시트, 유모차, 유아용가구, 펫 유모차, ACC.
- `유형별`: 컨버터블, 라이트트래블, 펫 비비 등
- `아이템별`: 구체적 제품명
- `색상별`: 색상 정보
- `패턴`: 무지, 단색, 패턴 등

#### 5. 유통 정보 (6개)
- `유통별`: 온라인, 오프라인, 기타
- `채널별`: 자사몰, 기타몰, 전문점, 백화점, 특판
- `매출명`: 구체적 매장명/쇼핑몰명
- `매장별`: 매장 형태 구분
- `지역`: 시도 단위 지역 구분
- `판매구분`: 매출 구분값

#### 6. 시간 차원 (5개) - 자동계산 지원
- `주차별`: "5월 4주" 형식
- `월별`: "5월" 형식  
- `분기별`: "2/4 분기" 형식
- `년별`: "2025년" 형식
- `요일`: 월/화/수/목/금/토/일

#### 7. 원가 정보 (4개)
- `공식원가단가`: 표준 원가 단가
- `소비자단가`: 소비자가 단가
- `원가금액`: 총 원가 금액
- `소비자가금액`: 총 소비자가 금액

#### 8. 기타 (3개)
- `브랜드존`: 뉴나, 리안/조이, 조이/뉴나
- `뉴나브랜드조닝`: 벽면, 아일랜드, 코너
- `가결산구분`: 자동 집계용 구분값

### 📦 상품마스터 시트 상세

#### 컬럼 구조 (16개)
```
ERPia 코드, i_CUBE 코드, 상품명, 브랜드(4), 2브랜드,
제품군, 유형별, 아이템별, 일보명, 색상, 패턴,
비고_10, ANS, 판매일보 적용원가, 소비자가, 운영가
```

#### 주요 기능
- ERPia 시스템과의 상품 매핑
- 브랜드 → 제품군 → 유형별 → 아이템별 계층 구조
- 원가/소비자가/운영가 가격 체계
- 자동분류를 위한 마스터 데이터

### 🏢 거래처마스터 시트 상세

#### 컬럼 구조 (20개)
```
코드(구), 자체코드(구), 거래처명(구), 유통별(구), 채널별(구), 매출명(구), 매장형태(구),
매장구분, 이알피아코드, 더존코드, 거래처명, 거래상태, 유통별, 채널별, 매출명,
매장형태, 브랜드존, 뉴나 브랜드 조닝, 지역, 가결산 구분값
```

#### 주요 기능
- 유통별(온라인/오프라인) → 채널별 → 매출명 구조
- ERPia/더존 시스템 연동 코드 매핑
- 지역별, 브랜드존별 분류
- 가결산 구분으로 자동 집계 지원

## 🔍 데이터 검증 규칙

### 필수 검증 항목

#### 매출데이터 시트
- `일자`: 날짜 형식 (YYYY-MM-DD) 필수
- `수량`: 숫자 (0 이상)
- `단가`: 숫자 (0 이상)
- `매출액`: 숫자 필수
- `브랜드(대)`: 사전 정의된 값만 허용
- `유통별`: 온라인/오프라인/기타
- `채널별`: 자사몰/기타몰/전문점/백화점/특판

#### 상품마스터 시트
- `ERPia 코드`: 13자리 숫자
- `브랜드(4)`: 사전 정의된 브랜드만 허용
- `제품군`: 정의된 제품군만 허용
- `가격 정보`: 0 이상 숫자

#### 거래처마스터 시트
- `거래상태`: 거래중/종료
- `유통별/채널별`: 일관된 분류 체계
- `지역`: 표준 시도명

## 🚀 업로드 프로세스

### 1. 템플릿 다운로드
```bash
# 템플릿 생성 (개발팀용)
python create_excel_upload_template.py
```

### 2. 데이터 입력
1. **매출데이터 시트**: 일별 매출 거래 내역 입력
2. **상품마스터 시트**: 새로운 상품 정보 입력 (옵션)
3. **거래처마스터 시트**: 새로운 거래처 정보 입력 (옵션)

### 3. 데이터 검증
- 📋 검증규칙 시트 참고
- 필수 컬럼 입력 확인
- 데이터 형식 준수 확인
- 브랜드/채널 등 분류값 정합성 확인

### 4. 시스템 업로드
1. MIS v2 시스템 > 매출분석 > Excel 업로드
2. 파일 선택 및 업로드
3. 처리 진행상황 모니터링
4. 오류 시 수정 후 재업로드
5. 완료 후 매출분석 메뉴에서 확인

## ⚠️ 주의사항 및 제한사항

### 📏 크기 제한
- 파일 크기: 10MB 이하
- 데이터 행 수: 20,000행 이하 권장
- 처리 시간: 대용량일 경우 3-5분 소요

### 📋 필수 규칙
- 일자는 반드시 YYYY-MM-DD 형식
- 필수 컬럼 누락 시 업로드 실패
- 브랜드, 채널 등은 기존 체계 준수
- 숫자 컬럼에 문자 입력 불가

### 🔒 데이터 품질
- 중복 데이터 자동 제거
- NULL 값 기본값 처리
- 잘못된 형식 자동 교정
- 범위 벗어나는 값 오류 처리

## 💡 업로드 전략

### 🎯 우선순위
1. **상품마스터**: 새 상품이 있다면 먼저 업로드
2. **거래처마스터**: 새 거래처가 있다면 먼저 업로드  
3. **매출데이터**: 마지막에 매출 데이터 업로드

### 📊 배치 처리
- 대용량 데이터는 월별/주별로 분할 업로드
- 일별 매출은 300건씩 배치 처리
- 오류 발생 시 중단점부터 재시작 지원

### 🔄 데이터 동기화
- 업로드 후 레거시 DB와 자동 동기화
- ERPia API와 실시간 연동
- 업로드 로그 및 이력 관리

## 📞 지원 및 문의

### 🛠️ 기술 지원
- **시스템 오류**: IT 지원팀
- **업로드 실패**: 시스템 관리자
- **템플릿 문제**: 개발팀

### 📊 데이터 문의  
- **매출분석 관련**: 매출분석 담당자
- **상품분류 관련**: 상품기획팀
- **거래처분류 관련**: 영업팀

### 📋 업데이트 내역
- **v1.0**: 초기 템플릿 생성 (2025-08-05)
- 분석된 Excel 구조 기반 45개 컬럼 지원
- 3개 마스터 시트 및 검증 규칙 포함
- 다중 브랜드(NUNA, JOIE, 리안펫) 지원

---

📅 **생성일**: 2025-08-05  
📝 **버전**: v1.0  
🔄 **다음 업데이트**: 멀티테넌트 지원 (에이원 월드 추가) 